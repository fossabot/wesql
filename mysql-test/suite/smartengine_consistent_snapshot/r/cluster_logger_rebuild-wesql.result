# Connection mysqld.1 data leader
# Wait for first snapshots to be generated after startup 
use test;
CREATE TABLE t1(c1 int) ENGINE=SMARTENGINE ;
INSERT INTO t1 values(1);
INSERT INTO t1 values(2);
INSERT INTO t1 values(3);
INSERT INTO t1 values(4);
SELECT * FROM t1;
c1
1
2
3
4
FLUSH logs;
INSERT INTO t1 values(5);
INSERT INTO t1 values(6);
INSERT INTO t1 values(7);
INSERT INTO t1 values(8);
SELECT * FROM t1;
c1
1
2
3
4
5
6
7
8
# Wait for all binlog persistent
# Connection mysqld.2 logger1
# Kill logger1
# Kill the server
# Force remove logger1 datadir
# Force rmdir logger1 datadir for recovery test
# Initialize logger1
# Start logger1
# restart
include/assert.inc [logger start index match]
# Connection mysqld.1 data leader
use test;
SELECT * FROM t1;
c1
1
2
3
4
5
6
7
8
# Cleanup
DROP TABLE t1;
