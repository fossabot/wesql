--source suite/smartengine/include/have_smartengine.inc

--disable_warnings
DROP TABLE IF EXISTS a;
--enable_warnings

create table a (id int, value int,  primary key (id) comment 'cf_a') ENGINE = SMARTENGINE;

--disable_query_log
let $i = 1;
while ($i <= 30000) {
  let $insert = INSERT INTO a VALUES($i, $i);
  inc $i;
  eval $insert;
}
--enable_query_log

#set smartengine_bulk_load=1;
#set smartengine_commit_in_the_middle=1;
alter table a add index v (value) COMMENT 'cf_a';
#set smartengine_bulk_load=0;
#set smartengine_commit_in_the_middle=0;
select count(*) from a force index(primary);
select count(*) from a force index(v);

DROP TABLE a;

--source suite/smartengine/include/check_smartengine_log_error.inc
