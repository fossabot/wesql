#
# DDL crash and recovery
#
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
create table t1(id int);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
show tables;
Tables_in_test
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
create table t2(id int);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
show tables;
Tables_in_test
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
create table t3(id int);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
show tables;
Tables_in_test
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1	
create table t4(id int);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-2	
set debug = 'd, crash_create_non_critical_before_update_index';
create table t5(id int);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-3	
set debug = 'd, crash_create_critical_before_update_index';
create table t6(id int);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-4	
set debug = 'd, crash_create_after_update_index';
create table t7(id int);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-5	
set debug = 'd, crash_create_before_rename_index_file';
create table t8(id int);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-6	
set debug = 'd, crash_create_after_rename_index_file';
create table t9(id int);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-7	
set debug = 'd, crash_after_flush_engine_log';
create table t11(id int);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-7	
show tables;
Tables_in_test
t4
t5
t6
t7
t8
t9
drop table t4,t5,t6,t7,t8,t9;
#
# Normal DML (1000) crash and recovery
#
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
create table t(id int);
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
insert into t values (1000);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
insert into t values (1001);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
set debug = 'd, consensus_replication_crash_after_write_cache';
insert into t values (1002);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
set debug = 'd, consensus_replication_crash_after_sync';
insert into t values (1003);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-9	
set debug = 'd, crash_after_flush_binlog';
insert into t values (1004);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-10	
set debug = 'd, consensus_replication_crash_after_commit';
insert into t values (1005);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-11	
set debug = 'd, crash_create_non_critical_before_update_index';
insert into t values(1006);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-12	
set debug = 'd, crash_create_critical_before_update_index';
insert into t values(1007);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-13	
set debug = 'd, crash_create_after_update_index';
insert into t values(1008);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-14	
set debug = 'd, crash_create_before_rename_index_file';
insert into t values(1009);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-15	
set debug = 'd, crash_create_after_rename_index_file';
insert into t values(1010);
flush logs;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-16	
set debug = 'd, crash_after_flush_engine_log';
insert into t values(1012);
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-16	
select * from t;
id
1004
1005
1006
1007
1008
1009
1010
drop table t;
create table t_large(id int primary key, data longblob);
SET @@GLOBAL.DEBUG= '+d,crash_during_large_event_binlog_flush';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-18	
insert into t_large values (1, repeat("a", 2048576));
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SET @@GLOBAL.DEBUG= '+d, crash_during_large_event_binlog_flush_slow';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-18	
insert into t_large values (2, repeat("b", 2048576));
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-18	
SET @@GLOBAL.DEBUG= 'd, disable_se_persists_gtid';
SET @@GLOBAL.DEBUG= '+d, crash_during_large_event_receive';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-18	
insert into t_large values (3, repeat("c", 2048576));
insert into t_large values (4, repeat("c", 1));
SET @@GLOBAL.DEBUG= 'd, disable_se_persists_gtid';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-20	
SET @@GLOBAL.DEBUG= '+d,crash_during_large_event_receive_slow';
insert into t_large values (5, repeat("d", 2048576));
insert into t_large values (6, repeat("d", 1));
SET @@GLOBAL.DEBUG= 'd, disable_se_persists_gtid';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-22	
select id from t_large;
id
3
4
5
6
drop table t_large;
#
# Xa Prepare crash and Rollback after recovery(2000)
#
create table t(id int);
xa begin '2001';
insert into t values (2001);
xa end '2001';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa prepare '2001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '2002';
insert into t values (2002);
xa end '2002';
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa prepare '2002';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '2003';
insert into t values (2003);
xa end '2003';
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa prepare '2003';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '2004';
insert into t values (2004);
xa end '2004';
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-24	
xa prepare '2004';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-25	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	2004
xa rollback '2004';
select * from t;
id
#
# Xa Prepare crash and Commit after recovery(2000) 
#
xa begin '3001';
insert into t values (3001);
xa end '3001';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa prepare '3001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '3002';
insert into t values (3002);
xa end '3002';
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa prepare '3002';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '3003';
insert into t values (3003);
xa end '3003';
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa prepare '3003';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '3004';
insert into t values (3004);
xa end '3004';
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-26	
xa prepare '3004';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-27	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	3004
xa commit '3004';
select * from t;
id
3004
#
# Xa Commit crash and recovery (4000)
#
xa begin '4001';
insert into t values (4001);
xa end '4001';
xa prepare '4001';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-29	
xa commit '4001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-29	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	4001
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-29	
xa commit '4001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-29	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	4001
xa commit '4001';
xa begin '4002';
insert into t values (4002);
xa end '4002';
xa prepare '4002';
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-31	
xa commit '4002';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-31	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	4002
xa commit '4002';
xa begin '4003';
insert into t values (4003);
xa end '4003';
xa prepare '4003';
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-33	
xa commit '4003';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-34	
xa recover;
formatID	gtrid_length	bqual_length	data
select * from t;
id
3004
4001
4002
4003
#
# Xa Rollback crash and recovery (5000)
#
xa begin '5001';
insert into t values (5001);
xa end '5001';
xa prepare '5001';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-35	
xa rollback '5001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-35	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	5001
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-35	
xa rollback '5001';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-35	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	5001
xa rollback '5001';
xa begin '5002';
insert into t values (5002);
xa end '5002';
xa prepare '5002';
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-37	
xa rollback '5002';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-37	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	5002
xa rollback '5002';
xa begin '5003';
insert into t values (5003);
xa end '5003';
xa prepare '5003';
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-39	
xa rollback '5003';
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
xa recover;
formatID	gtrid_length	bqual_length	data
select * from t;
id
3004
4001
4002
4003
#
# Crash happened on XA COMMIT ONE PHASE (5500)
#
xa begin '5501';
insert into t values (5501);
xa end '5501';
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
XA COMMIT "5501" ONE PHASE;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
xa begin '5502';
insert into t values (5502);
xa end '5502';
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
XA COMMIT "5502" ONE PHASE;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
xa begin '5503';
insert into t values (5503);
xa end '5503';
set debug = 'd, consensus_replication_crash_after_sync';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
XA COMMIT "5503" ONE PHASE;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
xa begin '5504';
insert into t values (5504);
xa end '5504';
set debug = 'd, consensus_replication_crash_after_commit';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-40	
XA COMMIT "5504" ONE PHASE;
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-41	
select * from t;
id
3004
4001
4002
4003
5504
drop table t;
#
# Xa with binlog And Crash at flush stage (6000)
#
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
create table t1(id int);
create table t2(id int);
xa begin '6001';
insert into t1 values (6001);
xa end '6001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_flush_stage SIGNAL prepare_6001_ready WAIT_FOR no_signal';
xa prepare '6001';
SET DEBUG_SYNC = "now WAIT_FOR prepare_6001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-47
drop table t2;
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-47	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '6001';
insert into t1 values (6001);
xa end '6001';
xa prepare '6001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_flush_stage SIGNAL commit_6001_ready WAIT_FOR no_signal';
xa commit '6001';
SET DEBUG_SYNC = "now WAIT_FOR commit_6001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-48
drop table t2;
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-48	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	6001
xa commit '6001';
show tables;
Tables_in_test
t1
t2
#
# Xa And DML Crash after flush stage before sync stage (7000)
#
xa begin '7001';
insert into t1 values (7001);
xa end '7001';
SET DEBUG_SYNC= 'bgc_after_flush_stage_before_sync_stage SIGNAL prepare_7001_ready WAIT_FOR no_signal';
xa prepare '7001';
SET DEBUG_SYNC = "now WAIT_FOR prepare_7001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-49
drop table t2;
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-49	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '7001';
insert into t1 values (7001);
xa end '7001';
xa prepare '7001';
SET DEBUG_SYNC= 'bgc_after_flush_stage_before_sync_stage SIGNAL commit_7001_ready WAIT_FOR no_signal';
xa commit '7001';
SET DEBUG_SYNC = "now WAIT_FOR commit_7001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-50
drop table t2;
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-50	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	7001
xa commit '7001';
xa begin '7002';
insert into t1 values (7002);
xa end '7002';
xa prepare '7002';
SET DEBUG_SYNC= 'bgc_after_flush_stage_before_sync_stage SIGNAL rollback_7002_ready WAIT_FOR no_signal';
xa rollback '7002';
SET DEBUG_SYNC = "now WAIT_FOR rollback_7002_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-52
drop table t2;
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-52	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	7002
xa rollback '7002';
#
# Xa And DML Crash at sync stage (8000)
#
xa begin '8001';
insert into t1 values (8001);
xa end '8001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_sync_stage SIGNAL prepare_8001_ready WAIT_FOR no_signal';
xa prepare '8001';
SET DEBUG_SYNC = "now WAIT_FOR prepare_8001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-53
insert into t1 values (8002);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-53	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '8001';
insert into t1 values (8001);
xa end '8001';
xa prepare '8001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_sync_stage SIGNAL commit_8001_ready WAIT_FOR no_signal';
xa commit '8001';
SET DEBUG_SYNC = "now WAIT_FOR commit_8001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-54
insert into t1 values (8003);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-54	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	8001
xa commit '8001';
select * from t1;
id
6001
7001
8001
show tables;
Tables_in_test
t1
t2
xa begin '8002';
insert into t1 values (8004);
xa end '8002';
xa prepare '8002';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_sync_stage SIGNAL rollback_8002_ready WAIT_FOR no_signal';
xa rollback '8002';
SET DEBUG_SYNC = "now WAIT_FOR rollback_8002_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-56
insert into t1 values (8005);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-56	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	8002
xa rollback '8002';
select * from t1;
id
6001
7001
8001
#
# Xa Crash after sync stage before commit stage (9000)
#
xa begin '9001';
insert into t1 values (9001);
xa end '9001';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL prepare_9001_ready WAIT_FOR no_signal';
xa prepare '9001';
SET DEBUG_SYNC = "now WAIT_FOR prepare_9001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-57
insert into t1 values (9002);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-57
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '9001';
insert into t1 values (9001);
xa end '9001';
xa prepare '9001';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL commit_9001_ready WAIT_FOR no_signal';
xa commit '9001';
SET DEBUG_SYNC = "now WAIT_FOR commit_9001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-58
insert into t1 values (9003);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-58	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	9001
xa commit '9001';
xa begin '9002';
insert into t1 values (9004);
xa end '9002';
xa prepare '9002';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL rollback_9002_ready WAIT_FOR no_signal';
xa rollback '9002';
SET DEBUG_SYNC = "now WAIT_FOR rollback_9002_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-60
insert into t1 values (9005);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-60	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	9002
xa rollback '9002';
xa begin '9003';
insert into t1 values (9006);
xa end '9003';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL prepare_9003_ready WAIT_FOR no_signal';
xa prepare '9003';
SET DEBUG_SYNC = "now WAIT_FOR prepare_9003_ready";
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-61
insert into t1 values (9007);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-61	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '9003';
insert into t1 values (9006);
xa end '9003';
xa prepare '9003';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL commit_9003_ready WAIT_FOR no_signal';
xa commit '9003';
SET DEBUG_SYNC = "now WAIT_FOR commit_9003_ready";
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-62
insert into t1 values (9008);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-62	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	9003
xa commit '9003';
xa begin '9004';
insert into t1 values (9009);
xa end '9004';
xa prepare '9004';
SET DEBUG_SYNC= 'bgc_after_sync_stage_before_commit_stage SIGNAL rollback_9004_ready WAIT_FOR no_signal';
xa rollback '9004';
SET DEBUG_SYNC = "now WAIT_FOR rollback_9004_ready";
set debug = 'd, crash_commit_after_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-64
insert into t1 values (9010);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-64	
xa recover;
formatID	gtrid_length	bqual_length	data
1	4	0	9004
xa rollback '9004';
#
# Xa Crash at commit stage (10000)
#
xa begin '10001';
insert into t1 values (10001);
xa end '10001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_commit_stage SIGNAL prepare_10001_ready WAIT_FOR no_signal';
xa prepare '10001';
SET DEBUG_SYNC = "now WAIT_FOR prepare_10001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-65
insert into t1 values (10002);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-65	
xa recover;
formatID	gtrid_length	bqual_length	data
xa begin '10001';
insert into t1 values (10001);
xa end '10001';
xa prepare '10001';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_commit_stage SIGNAL commit_10001_ready WAIT_FOR no_signal';
xa commit '10001';
SET DEBUG_SYNC = "now WAIT_FOR commit_10001_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-66
insert into t1 values (10003);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-66	
xa recover;
formatID	gtrid_length	bqual_length	data
1	5	0	10001
xa commit '10001';
xa begin '10002';
insert into t1 values (10004);
xa end '10002';
xa prepare '10002';
SET DEBUG_SYNC= 'bgc_after_enrolling_for_commit_stage SIGNAL rollback_10002_ready WAIT_FOR no_signal';
xa rollback '10002';
SET DEBUG_SYNC = "now WAIT_FOR rollback_10002_ready";
set debug = 'd, crash_commit_before_log';
SELECT @@GLOBAL.GTID_EXECUTED;
@@GLOBAL.GTID_EXECUTED
MASTER_UUID:1-68
insert into t1 values (10005);
ERROR HY000: Lost connection to MySQL server during query
ERROR HY000: Lost connection to MySQL server during query
SET @@GLOBAL.DEBUG= 'd, disable_gtid_background_persister';
SELECT @@GLOBAL.GTID_EXECUTED, @@GLOBAL.GTID_OWNED;
@@GLOBAL.GTID_EXECUTED	@@GLOBAL.GTID_OWNED
MASTER_UUID:1-68	
xa recover;
formatID	gtrid_length	bqual_length	data
1	5	0	10002
xa rollback '10002';
select * from t1;
id
6001
7001
8001
9001
9006
10001
drop table t1;
drop table t2;
SET @@GLOBAL.DEBUG= '';
