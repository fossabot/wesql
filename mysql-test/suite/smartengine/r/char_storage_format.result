DROP TABLE IF EXISTS t1;
##### ROW FORMAT #####
CREATE TABLE t1 (c1 int primary key, c2 char(0), c3 char(20), c4 char(6)) engine = SMARTENGINE;
INSERT INTO t1 VALUES (1, "", "", " ");
INSERT INTO t1 VALUES (2, "", "zds", "ppl");
INSERT INTO t1 VALUES (3, "", " zds", "ppl ");
INSERT INTO t1 VALUES (4, "", "   zds", "ppl   ");
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$$	$$
2	$$	$zds$	$ppl$
3	$$	$ zds$	$ppl$
4	$$	$   zds$	$ppl$
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	0	0
2	0	3	3
3	0	4	3
4	0	6	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$                    $	$      $
2	$$	$zds                 $	$ppl   $
3	$$	$ zds                $	$ppl   $
4	$$	$   zds              $	$ppl   $
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	20	6
2	0	20	6
3	0	20	6
4	0	20	6
SET SQL_MODE = @OLD_SQL_MODE;
SET GLOBAL SMARTENGINE_FORCE_FLUSH_MEMTABLE_NOW = ON;
restarting
# restart
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$$	$$
2	$$	$zds$	$ppl$
3	$$	$ zds$	$ppl$
4	$$	$   zds$	$ppl$
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	0	0
2	0	3	3
3	0	4	3
4	0	6	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$                    $	$      $
2	$$	$zds                 $	$ppl   $
3	$$	$ zds                $	$ppl   $
4	$$	$   zds              $	$ppl   $
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	20	6
2	0	20	6
3	0	20	6
4	0	20	6
SET SQL_MODE = @OLD_SQL_MODE;
DROP TABLE t1;
##### COLUMNAR FORMAT #####
CREATE TABLE t1 (c1 int primary key, c2 char(0), c3 char(20), c4 char(6)) engine = SMARTENGINE, engine_attribute='{"data_format":"columnar"}';
INSERT INTO t1 VALUES (1, "", "", " ");
INSERT INTO t1 VALUES (2, "", "zds", "ppl");
INSERT INTO t1 VALUES (3, "", " zds", "ppl ");
INSERT INTO t1 VALUES (4, "", "   zds", "ppl   ");
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$$	$$
2	$$	$zds$	$ppl$
3	$$	$ zds$	$ppl$
4	$$	$   zds$	$ppl$
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	0	0
2	0	3	3
3	0	4	3
4	0	6	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$                    $	$      $
2	$$	$zds                 $	$ppl   $
3	$$	$ zds                $	$ppl   $
4	$$	$   zds              $	$ppl   $
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	20	6
2	0	20	6
3	0	20	6
4	0	20	6
SET SQL_MODE = @OLD_SQL_MODE;
SET GLOBAL SMARTENGINE_FORCE_FLUSH_MEMTABLE_NOW = ON;
restarting
# restart
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$$	$$
2	$$	$zds$	$ppl$
3	$$	$ zds$	$ppl$
4	$$	$   zds$	$ppl$
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	0	0
2	0	3	3
3	0	4	3
4	0	6	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3, CONCAT('$', c4, '$') AS c4 FROM t1;
c1	c2	c3	c4
1	$$	$                    $	$      $
2	$$	$zds                 $	$ppl   $
3	$$	$ zds                $	$ppl   $
4	$$	$   zds              $	$ppl   $
SELECT c1, LENGTH(c2), LENGTH(c3), LENGTH(c4) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)	LENGTH(c4)
1	0	20	6
2	0	20	6
3	0	20	6
4	0	20	6
SET SQL_MODE = @OLD_SQL_MODE;
DROP TABLE t1;
##### DDL #####
CREATE TABLE t1 (c1 int primary key, c2 char(5)) engine = SMARTENGINE;
INSERT INTO t1 VALUES (1, "zds");
INSERT INTO t1 VALUES (2, "ppl");
SELECT c1, CONCAT('$', c2, '$') AS c2 FROM t1;
c1	c2
1	$zds$
2	$ppl$
SELECT c1, LENGTH(c2) FROM t1;
c1	LENGTH(c2)
1	3
2	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2 FROM t1;
c1	c2
1	$zds  $
2	$ppl  $
SELECT c1, LENGTH(c2) FROM t1;
c1	LENGTH(c2)
1	5
2	5
SET SQL_MODE = @OLD_SQL_MODE;
#### modify char width
ALTER TABLE t1 MODIFY COLUMN c2 CHAR(10);
SELECT c1, CONCAT('$', c2, '$') AS c2 FROM t1;
c1	c2
1	$zds$
2	$ppl$
SELECT c1, LENGTH(c2) FROM t1;
c1	LENGTH(c2)
1	3
2	3
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2 FROM t1;
c1	c2
1	$zds       $
2	$ppl       $
SELECT c1, LENGTH(c2) FROM t1;
c1	LENGTH(c2)
1	10
2	10
SET SQL_MODE = @OLD_SQL_MODE;
#### add new column with char type
ALTER TABLE t1 ADD COLUMN c3 CHAR(20) DEFAULT "summer";
INSERT INTO t1 VALUES (3, "ppl", "happy");
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c3
1	$zds$	$summer$
2	$ppl$	$summer$
3	$ppl$	$happy$
SELECT c1, LENGTH(c2), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)
1	3	6
2	3	6
3	3	5
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c3
1	$zds       $	$summer              $
2	$ppl       $	$summer              $
3	$ppl       $	$happy               $
SELECT c1, LENGTH(c2), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c3)
1	10	20
2	10	20
3	10	20
SET SQL_MODE = @OLD_SQL_MODE;
#### add new column in the middle
ALTER TABLE t1 ADD COLUMN c4 CHAR(0) AFTER c2;
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c4, '$') AS c4, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c4	c3
1	$zds$	NULL	$summer$
2	$ppl$	NULL	$summer$
3	$ppl$	NULL	$happy$
SELECT c1, LENGTH(c2), LENGTH(c4), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c4)	LENGTH(c3)
1	3	NULL	6
2	3	NULL	6
3	3	NULL	5
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c4, '$') AS c4, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c4	c3
1	$zds       $	NULL	$summer              $
2	$ppl       $	NULL	$summer              $
3	$ppl       $	NULL	$happy               $
SELECT c1, LENGTH(c2), LENGTH(c4), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c4)	LENGTH(c3)
1	10	NULL	20
2	10	NULL	20
3	10	NULL	20
SET SQL_MODE = @OLD_SQL_MODE;
INSERT INTO t1 VALUES (4, "ppl", "", "zds");
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c4, '$') AS c4, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c4	c3
1	$zds$	NULL	$summer$
2	$ppl$	NULL	$summer$
3	$ppl$	NULL	$happy$
4	$ppl$	$$	$zds$
SELECT c1, LENGTH(c2), LENGTH(c4), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c4)	LENGTH(c3)
1	3	NULL	6
2	3	NULL	6
3	3	NULL	5
4	3	0	3
SET @OLD_SQL_MODE = @@SQL_MODE;
SET SQL_MODE = 'PAD_CHAR_TO_FULL_LENGTH';
Warnings:
Warning	3090	Changing sql mode 'PAD_CHAR_TO_FULL_LENGTH' is deprecated. It will be removed in a future release.
SELECT c1, CONCAT('$', c2, '$') AS c2, CONCAT('$', c4, '$') AS c4, CONCAT('$', c3, '$') AS c3 FROM t1;
c1	c2	c4	c3
1	$zds       $	NULL	$summer              $
2	$ppl       $	NULL	$summer              $
3	$ppl       $	NULL	$happy               $
4	$ppl       $	$$	$zds                 $
SELECT c1, LENGTH(c2), LENGTH(c4), LENGTH(c3) FROM t1;
c1	LENGTH(c2)	LENGTH(c4)	LENGTH(c3)
1	10	NULL	20
2	10	NULL	20
3	10	NULL	20
4	10	0	20
SET SQL_MODE = @OLD_SQL_MODE;
DROP TABLE t1;
