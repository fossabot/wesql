set global consistent_snapshot_innodb_tar_mode='tar';
set global consistent_snapshot_smartengine_tar_mode='tar';
CREATE DATABASE db1;
CREATE TABLE t1(c1 int) ENGINE=SMARTENGINE ;
INSERT INTO t1 values(1);
INSERT INTO t1 values(2);
INSERT INTO t1 values(3);
INSERT INTO t1 values(4);
SELECT * FROM t1;
c1
1
2
3
4
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `c1` int DEFAULT NULL
) ENGINE=SMARTENGINE DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci
# Wait for at least 1 snapshots to be generated 
set global consistent_snapshot_innodb_tar_mode='tar_and_compress';
set global consistent_snapshot_smartengine_tar_mode='tar_and_compress';
INSERT INTO t1 values(5);
INSERT INTO t1 values(6);
# Wait for at least 1 snapshots to be generated 
# Shutdown server
# Force rmdir datadir for recovery test
# Create an empty data directory...
# Recovery start from object store.
# restart
SELECT * FROM t1;
c1
1
2
3
4
5
6
DROP TABLE t1;
DROP DATABASE db1;
