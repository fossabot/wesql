create table test.t1(a int primary key) engine=innodb;
create table test.t2(a int primary key)engine=myisam;

flush binary logs;
#flush des_key_file;
flush engine logs;
flush error logs;
flush general logs;
flush hosts;
flush logs;
flush privileges;
flush optimizer_costs;
#flush query cache;
flush relay logs;
flush status;
flush user_resources;
#flush rds_audit logs;

flush tables;
unlock tables;
flush tables test.t1;
unlock tables;
flush tables with read lock;
unlock tables;
flush tables test.t1 with read lock;
unlock tables;
flush tables test.t1 for export;
unlock tables;

repair table test.t2;
analyze table test.t1;
optimize table test.t1;

--connect (foll,127.0.0.1,root,,test,$MYPORT_2)
flush binary logs;
#--error ER_CONSENSUS_NOT_READY
#flush des_key_file;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush engine logs;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush error logs;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush general logs;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush hosts;
flush logs;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush privileges;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush optimizer_costs;
#--error ER_BINLOG_LOGGING_IMPOSSIBLE
#flush query cache;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush relay logs;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush status;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush user_resources;
#flush rds_audit logs;

--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush tables;
unlock tables;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
flush tables test.t1;
unlock tables;
flush tables with read lock;
unlock tables;
flush tables test.t1 with read lock;
unlock tables;
flush tables test.t1 for export;
unlock tables;

--error ER_BINLOG_LOGGING_IMPOSSIBLE
repair table test.t2;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
analyze table test.t1;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
optimize table test.t1;
--error ER_BINLOG_LOGGING_IMPOSSIBLE
truncate table test.t1;

set sql_log_bin=0;

flush binary logs;
#flush des_key_file;
flush engine logs;
flush error logs;
flush general logs;
flush hosts;
flush logs;
flush privileges;
flush optimizer_costs;
#flush query cache;
flush relay logs;
flush status;
flush user_resources;
#flush rds_audit logs;

flush tables;
unlock tables;
flush tables test.t1;
unlock tables;
flush tables with read lock;
unlock tables;
flush tables test.t1 with read lock;
unlock tables;
flush tables test.t1 for export;
unlock tables;

repair table test.t2;
analyze table test.t1;
optimize table test.t1;
truncate table test.t1;

connection default;
drop table t1, t2;
